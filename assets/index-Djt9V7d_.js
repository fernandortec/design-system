import{r as s}from"./index-B4xtDKTc.js";import{$ as v,a as A,b as p}from"./index-B_Qnr3_3.js";import{r as h}from"./index-CSieDl-Q.js";function S(e,n,{checkForDefaultPrevented:c=!0}={}){return function(o){if(e==null||e(o),c===!1||!o.defaultPrevented)return n==null?void 0:n(o)}}function g({prop:e,defaultProp:n,onChange:c=()=>{}}){const[t,o]=b({defaultProp:n,onChange:c}),a=e!==void 0,m=a?e:t,f=v(c),u=s.useCallback(r=>{if(a){const i=typeof r=="function"?r(e):r;i!==e&&f(i)}else o(r)},[a,e,o,f]);return[m,u]}function b({defaultProp:e,onChange:n}){const c=s.useState(e),[t]=c,o=s.useRef(t),a=v(n);return s.useEffect(()=>{o.current!==t&&(a(t),o.current=t)},[t,o,a]),c}function P(e,n){return s.useReducer((c,t)=>{const o=n[c][t];return o??c},e)}const M=e=>{const{present:n,children:c}=e,t=O(n),o=typeof c=="function"?c({present:t.isPresent}):s.Children.only(c),a=A(t.ref,o.ref);return typeof c=="function"||t.isPresent?s.cloneElement(o,{ref:a}):null};M.displayName="Presence";function O(e){const[n,c]=s.useState(),t=s.useRef({}),o=s.useRef(e),a=s.useRef("none"),m=e?"mounted":"unmounted",[f,u]=P(m,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return s.useEffect(()=>{const r=N(t.current);a.current=f==="mounted"?r:"none"},[f]),p(()=>{const r=t.current,d=o.current;if(d!==e){const $=a.current,l=N(r);e?u("MOUNT"):l==="none"||(r==null?void 0:r.display)==="none"?u("UNMOUNT"):u(d&&$!==l?"ANIMATION_OUT":"UNMOUNT"),o.current=e}},[e,u]),p(()=>{if(n){const r=i=>{const l=N(t.current).includes(i.animationName);i.target===n&&l&&h.flushSync(()=>u("ANIMATION_END"))},d=i=>{i.target===n&&(a.current=N(t.current))};return n.addEventListener("animationstart",d),n.addEventListener("animationcancel",r),n.addEventListener("animationend",r),()=>{n.removeEventListener("animationstart",d),n.removeEventListener("animationcancel",r),n.removeEventListener("animationend",r)}}else u("ANIMATION_END")},[n,u]),{isPresent:["mounted","unmountSuspended"].includes(f),ref:s.useCallback(r=>{r&&(t.current=getComputedStyle(r)),c(r)},[])}}function N(e){return(e==null?void 0:e.animationName)||"none"}export{g as $,S as a,M as b};
